resize_canvas(1000, 1000)

const GAP = 50
const X0 = GAP
const Y0 = HEIGHT - GAP
const G = 1
const TIME = 60
const DELTA_TIME = 0.1

const create_point = (x, y) => {
    return {'x': x, 'y': y}
}

const compute_velocity = (target_t, target_x, target_y) => {
    const time = TIME - target_t
    const v0x = (target_x - X0) / time
    const v0y = (target_y - Y0 - 0.5 * G * time * time) / time
    return create_point(v0x, v0y)
}

const update_point = (time, point, velocity) => {
    if (point.y > HEIGHT - 10) {
        return;
    }
    point.x = velocity.x * time + X0
    point.y = 0.5 * G * time * time + velocity.y * time + Y0
}

const target_points = [
    create_point(520.0, 632.5),
    create_point(530.6794407459156, 631.9997148936559),
    create_point(541.0765492817549, 630.5289428417486),
    create_point(551.14620070683, 628.1328087449658),
    create_point(560.8432701204533, 624.8564375039953),
    create_point(570.1226326219373, 620.7449540195246),
    create_point(578.9391633105943, 615.8434831922414),
    create_point(587.2477372857364, 610.1971499228332),
    create_point(595.0032296466763, 603.8510791119878),
    create_point(602.1605154927262, 596.8503956603929),
    create_point(608.6744699231984, 589.240224468736),
    create_point(614.4999680374053, 581.0656904377049),
    create_point(619.5918849346593, 572.3719184679871),
    create_point(623.9050957142726, 563.2040334602705),
    create_point(627.3944754755578, 553.6071603152425),
    create_point(630.0148993178269, 543.6264239335909),
    create_point(631.7212423403925, 533.3069492160032),
    create_point(632.4683796425668, 522.6938610631672),
    create_point(632.2175320128215, 511.96571348730174),
    create_point(630.9851512378657, 501.493791439504),
    create_point(628.8161271928623, 491.3380452772983),
    create_point(625.7555847784993, 481.54359990137254),
    create_point(621.8486488954641, 472.1555802124143),
    create_point(617.1404444444445, 463.21911111111115),
    create_point(611.6760963261281, 454.77931749815076),
    create_point(605.5007294412026, 446.8813242742208),
    create_point(598.6594686903555, 439.57025634000894),
    create_point(591.1974389742746, 432.8912385962028),
    create_point(583.1597651936477, 426.8893959434901),
    create_point(574.5915722491621, 421.60985328255845),
    create_point(565.5379850415056, 417.0977355140955),
    create_point(556.0441284713661, 413.3981675387889),
    create_point(546.1551274394309, 410.55627425732627),
    create_point(535.9161068463877, 408.61718057039536),
    create_point(525.3721915929243, 407.6260113786837),
    create_point(514.6278084070756, 407.6260113786837),
    create_point(504.0838931536123, 408.6171805703953),
    create_point(493.8448725605691, 410.55627425732627),
    create_point(483.9558715286339, 413.39816753878887),
    create_point(474.4620149584943, 417.0977355140955),
    create_point(465.40842775083786, 421.60985328255845),
    create_point(456.8402348063523, 426.8893959434901),
    create_point(448.8025610257253, 432.89123859620287),
    create_point(441.3405313096445, 439.57025634000894),
    create_point(434.49927055879743, 446.88132427422084),
    create_point(428.32390367387194, 454.77931749815076),
    create_point(422.8595555555556, 463.2191111111111),
    create_point(418.15135110453593, 472.1555802124143),
    create_point(414.2444152215008, 481.54359990137254),
    create_point(411.18387280713773, 491.33804527729836),
    create_point(409.01484876213436, 501.493791439504),
    create_point(407.78246798717845, 511.96571348730174),
    create_point(407.53162035743316, 522.6938610631672),
    create_point(408.2787576596075, 533.3069492160032),
    create_point(409.9851006821731, 543.6264239335909),
    create_point(412.6055245244423, 553.6071603152425),
    create_point(416.09490428572735, 563.2040334602705),
    create_point(420.40811506534067, 572.3719184679871),
    create_point(425.5000319625946, 581.0656904377049),
    create_point(431.32553007680156, 589.2402244687361),
    create_point(437.83948450727377, 596.8503956603929),
    create_point(444.99677035332365, 603.8510791119878),
    create_point(452.75226271426357, 610.1971499228332),
    create_point(461.0608366894058, 615.8434831922414),
    create_point(469.87736737806273, 620.7449540195246),
    create_point(479.1567298795467, 624.8564375039953),
    create_point(488.8537992931701, 628.1328087449659),
    create_point(498.92345071824514, 630.5289428417486),
    create_point(509.3205592540844, 631.9997148936559),
    create_point(520.0, 632.5),
    create_point(519.982, 587.542),
    create_point(530.3709787138132, 586.7379912143333),
    create_point(540.4656736120633, 584.3599285929547),
    create_point(550.0878392459649, 580.4587577392969),
    create_point(559.0443258272453, 575.0955831602794),
    create_point(567.0338401483306, 568.4481126067681),
    create_point(573.8938279552509, 560.6729147225033),
    create_point(579.4996443232458, 551.9068108797271),
    create_point(571.8469973923118, 550.2082054868356),
    create_point(561.4380010610811, 550.1889181828368),
    create_point(551.0290047298503, 550.1696308788379),
    create_point(540.6200083986195, 550.1503435748391),
    create_point(530.2110120673888, 550.1310562708402),
    create_point(519.802015736158, 550.1117689668414),
    create_point(509.39301940492714, 550.0924816628425),
    create_point(498.98402307369633, 550.0731943588437),
    create_point(488.5750267424656, 550.0539070548448),
    create_point(478.16603041123483, 550.034619750846),
    create_point(467.757034080004, 550.0153324468471),
    create_point(460.4655255882442, 551.9073476544509),
    create_point(466.07105136307655, 560.6729557219803),
    create_point(472.93079556095114, 568.4478860421123),
    create_point(480.91998606680477, 575.0952139549963),
    create_point(489.8762843951795, 580.4584677232966),
    create_point(499.49858697707657, 584.3597975767052),
    create_point(509.59334276047196, 586.7379579302085),
    create_point(519.982, 587.5419999999999),
    create_point(587.5, 505.005),
    create_point(579.337540711306, 494.1727623422625),
    create_point(566.4318377222544, 490.00057887024616),
    create_point(553.4727727253301, 494.0039841100764),
    create_point(545.1690000000001, 504.731),
    create_point(452.5004, 505.005),
    create_point(460.67326860752667, 494.1656327416101),
    create_point(473.59377949576583, 490.00042854028715),
    create_point(486.5585728857825, 494.0257196832036),
    create_point(494.84860000000003, 504.7779999999999),
]

const points = target_points.map(_ => create_point(X0, Y0))
const velocities = target_points.map((p, i) => compute_velocity(i * DELTA_TIME, p.x, p.y))

let t = 0

const update = () => {
    clear_canvas()

    for (let i=0; i<points.length; i++) {
        const time = i * DELTA_TIME
        if (t <= time) {
            continue;
        }
        update_point(t - time, points[i], velocities[i])
        draw_rectangle(points[i].x, points[i].y, 3, 3, 'yellow')
    }

    t += 0.3

    requestAnimationFrame(update)
}

update()